\documentclass[main.tex]{subfiles}
\begin{document}

\section{Introduction and conventions}
\label{sec:introduction_and_conventions}

\subsection{Introduction}
\label{ssc:introduction}

In topology, one often studies spaces via algebraic invariants associated to them. One such invariant of particular interest is the \emph{$n$th homology} of a space $X$, denoted $H_{n}(X)$. Roughly speaking, $H_{n}(X)$ is the abelian group consisting of formal sums of certain maps from the standard $n$-simplex $\Delta^{n}$ into $X$, considered modulo some equivalence relation.

It turns out to be fruitful to generalize $n$th homology. Formal sums are nothing else but $\Z$-linear combinations, and one can ask what happens when $\Z$ is replaced by some other commutative ring $R$. The associated invariant is then known as \emph{$n$th homology with coefficients in $R$}. One can even allow the ring $R$ to vary along $X$, or allow $R$ to be not only a ring, but an object of some appropriate category $\category{C}$. The structure which keeps track of these changing coefficients is called a $\category{C}$-\emph{local system}.

Classically speaking, when we say \emph{space,} we really mean \emph{topological space,} and $\category{C}$-local systems are modelled by locally-constant sheaves with values in $\category{C}$. In modern homotopy theory, one often takes \emph{space} to mean \emph{$\infty$-groupoid;} thought of in this way, a $\category{C}$-local system on a space $X$ is nothing more than a functor $X \to \category{C}$. This is the point of view that we will take.

With this point of view in mind, let $\category{C}$ be a cocomplete $\infty$-category. For any space $X$, denote by $\LS(\category{C})_{X}$ the $\infty$-category of $\category{C}$-local systems on $X$; that is, $\LS(\category{C})_{X} \simeq \Fun(X, \category{C})$. Recall that for any morphism $f\colon X \to Y$ of spaces, there are several associated functors between $\LS(\category{C})_{X}$ and $\LS(\category{C})_{Y}$. In particular:
\begin{itemize}
  \item The \emph{pullback functor} $f^{*}\colon \LS(\category{C})_{Y} \to \LS(\category{C})_{X}$ pulls back local systems on $Y$ to local systems on $X$, sending a local system $\mathcal{F}\colon Y \to \category{C}$ to the local system $f^{*}\mathcal{F}$ given by the composition
    \begin{equation*}
      \begin{tikzcd}
        X
        \arrow[r, "f"]
        & Y
        \arrow[r, "\mathcal{F}"]
        & \category{C}
      \end{tikzcd}.
    \end{equation*}

  \item The \emph{pushforward functor} $f_{!}\colon \LS(\category{C})_{X} \to \LS(\category{C})_{Y}$ pushes forward local systems via left Kan extension, sending a local system $\mathcal{G}\colon X \to \category{C}$ to the left Kan extension $f_{!}\mathcal{G}$.
    \begin{equation*}
      \begin{tikzcd}
        X
        \arrow[rr, "\mathcal{G}"]
        \arrow[dr, swap, "f"]
        && \category{C}
        \\
        & Y
        \arrow[ur, swap, "f_{!}G"]
      \end{tikzcd}
    \end{equation*}
\end{itemize}

Note that pulling back is contravariantly functorial, and pushing forward is covariantly functorial. One can combine these functorialities. Given the data of a diagram of spaces of the form
\begin{equation}
  \label{eq:span}
  \begin{tikzcd}
    & Y
    \arrow[dl, swap, "g"]
    \arrow[dr, "f"]
    \\
    X
    && X'
  \end{tikzcd},
\end{equation}
one can produce a functor $\LS(\category{C})_{X} \to \LS(\category{C})_{X'}$ via the composition
\begin{equation*}
  \begin{tikzcd}
    & \LS(\category{C})_{Y}
    \arrow[dr, "f_{!}"]
    \\
    \LS(\category{C})_{X}
    \arrow[ur, "g^{*}"]
    \arrow[rr, swap, "f_{!} \circ g^{*}"]
    && \LS(\category{C})_{X'}
  \end{tikzcd}.
\end{equation*}

The data of \hyperref[eq:span]{Diagram~\ref*{eq:span}} is known as a \emph{span} of spaces. It is natural to ask whether this construction can be extended to a functor $\Span(\S) \to \ICat$, where $\Span(\S)$ is an $\infty$-category whose objects are spaces, and whose morphisms are spans of spaces.

This is the second part of a two-part paper. In the first part, we provided a simplified proof of a theorem of Barwick \cite[Thm.~12.2]{spectralmackeyfunctors1}, which provides sufficient conditions for a functor of quasicategories $p\colon \category{C} \to \category{D}$ to yield a cocartesian fibration between $\infty$-categories of spans $\Span(p)\colon \Span(\category{C}) \to \Span(\category{D})$.

In this paper, we use this result to construct a functor $\hat{r}\colon \Span(\category{S}) \to \ICat$, which sends a space $X$ to the category $\LS(\category{C})_{X}$ of local systems on $X$, and a morphism in $\Span(\S)$ represented by a span
\begin{equation*}
  \begin{tikzcd}
    & Y
    \arrow[dl, swap, "g"]
    \arrow[dr, "f"]
    \\
    X
    && X'
  \end{tikzcd}
\end{equation*}
to the functor $f_{!} \circ g^{*}\colon \LS(\category{C})_{X} \to \LS(\category{C})_{X'}$. We further show that our functor is lax monoidal with respect to a monoidal structure on $\Span(\S)$ induced by the cartesian structure on $\S$, and the cartesian structure on $\ICat$. We do this by providing a general theory of situations in which one has lax functorial push-pull of local systems (monoidal Beck--Chevalley fibrations).

\subsection{Relation to previous work}
\label{ssc:relation_to_previous_work}

That pull-push of local systems can be written as a symmetric monoidal functor out of a category of spans is far from a new idea. Our approach differs from previous ones, however, in that our aim is to provide a simple, explicit construction of pull-push of local systems, without any pretensions of working in complete generality when it does not, in our view, lead to greater conceptual clarity.

There have been (to the knowledge of the author) two main works with results similar to those in this paper.
\begin{itemize}
  \item In \cite{spectralmackeyfunctors2}, similar results to those in \hyperref[ssc:monoidal_beck_chevalley_fibrations]{Subsection~\ref*{ssc:monoidal_beck_chevalley_fibrations}}, about monoidal Beck-Chevalley fibrations, are stated in a rather different situation. The application to local systems is not considered. We have treated these results in less generality.

  \item In \cite{gaitsgory2019study}, results about extending a functor out of a category of spans are proved, but more generally, more abstractly, and for the most part model-independently; there, spans come in $(\infty, 2)$-categories, modelled when necessary by complete 2-fold Segal spaces. Our approach is more explicit, based on hands-on combinatorial computations done in a quasicategorical twisted arrow category. We believe that the explicitness of our model will be useful in our future work.
\end{itemize}

\subsection{Outline}
\label{ssc:outline}

In \hyperref[sec:horn_filling_via_left_kan_extensions]{Section~\ref*{sec:horn_filling_via_left_kan_extensions}}, we generalize the universal property satisfied by Kan extensions of $1$-categories to $\infty$-categorical Kan extensions, and show how this universal property can be used to solve lifting problems in $\ICCat$.

Our proof that left Kan extensions enjoy this lifting property uses that left Kan extension is left adjoint to restriction; this can be used even if not all left Kan extensions along a functor exist. To formalize this, we introduce in \hyperref[ssc:adjunct_data]{Subsection~\ref*{ssc:adjunct_data}} the notion of a \emph{partial adjunction,} and use this to show that data on one side of an adjunction of $\infty$-categories can be used to fill adjunct data on the other side. Using this, we show in \hyperref[ssc:left_kan_implies_globally_left_kan]{Subsection~\ref*{ssc:left_kan_implies_globally_left_kan}} that this generalized lifting property really is satisfied.

In \hyperref[sec:local_systems]{Section~\ref*{sec:local_systems}}, we apply our results about left Kan extensions to show, via an explicit computation in an appropriate model (an $\infty$-categorical twisted arrow category), that left Kan extensions of local systems are $\infty$-functorial, i.e.\ extends to a functor $\S \to \ICat$. We then use this to show that pull-push functoriality extends to a functor $\Span(\S) \to \ICat$. In \hyperref[sec:the_monoidal_construction]{Section~\ref*{sec:the_monoidal_construction}}, we show that this construction can be endowed with a lax monoidal structure.

\subsection{General conventions and set-theoretic size issues}
\label{ssc:general_conventions}

We do our level best to adhere to the following terminological and typographical practices regarding various types of categories.
\begin{itemize}
  \item When we say `$\infty$-groupoid,' we will mean an $(\infty, 0)$-category, here always modelled by a Kan complex. We will in general denote $\infty$-groupoids by capital roman letters coming from the end of the alphabet: $X$, $Y$, \dots

  \item When we say `$\infty$-category,' we will mean an $(\infty, 1)$-category, usually modelled by a quasicategory. We will strive to denote $\infty$-categories by calligraphic letters typeset using the \textsf{eucal} package: $\category{C}$, $\category{D}$, \dots

  \item When we say `$\infty$-bicategory,' we will mean an $(\infty, 2)$-category in the sense of \cite{lurie2009infinity}, modelled by a fibrant scaled or marked-scaled\footnote{The theory of marked-scaled simplicial sets is given in \cite{garcia2cartesianfibrationsii}, and summarized in \hyperref[ssc:marked-scaled_model_structure]{Subsection~\ref*{ssc:marked-scaled_model_structure}}.} simplicial set; which one we mean should be clear from context. We will denote $(\infty, 2)$-categories by blackboard-bold letters typeset with the \textsf{mathbbol} package: $\CC$, $\DD$, \dots
\end{itemize}

We follow Lurie in our definitions of categories of $\infty$-categories (except for a few size-related transgressions explained below). We also adhere to the above typographical conventions in doing so. Thus:
\begin{itemize}
  \item The $(\infty, 1)$-category of spaces is $\S$. We model this as a quasicategory, constructed (as in \cite{highertopostheory}) as the homotopy-coherent nerve (as described in \cite[Sec.~1.1.5]{highertopostheory}, there called the simplicial nerve) of $\Kan$, the Kan-enriched category of Kan complexes.

  \item The $(\infty, 1)$-category of $(\infty,1)$-categories is $\ICat$. We model this as a quasicategory, defined to be the homotopy-coherent nerve of $\QCat$, the Kan-enriched category of quasicategories.

  \item The $(\infty,2)$-category of $(\infty, 1)$-categories is $\ICCat$. We model this as an $\infty$-bicategory, defined to be the scaled nerve (as described in \cite[Sec.~3.1]{lurie2009infinity}) of the $\SSetmk$-enriched category of quasicategories.

  \item The $(\infty, 1)$-category of $(\infty,2)$-categories is $\Cat_{(\infty, 2)}$. This is used only briefly, and will be modelled as the simplicial localization of $(\SSetms)^{f}$, the full subcategory of marked-scaled simplicial sets on fibrant objects, at the class of bicategorical equivalences.
\end{itemize}

For the most part, our conventions regarding set-theoretic size issues are standard. However, we will at several points point need to consider an $\infty$-category whose objects are large $\infty$-categories. The rigorous solution would be to introduce a series of nested Grothendieck universe, keep track of which one we are currently in, and carry this around as extra notation. However, there are no arguments in this paper which hinge on any set-theoretic size-issues, and the author feels that clarity is lost, rather than gained, by introducing this extraneous notation. Therefore, we will use the same notation for the large $\infty$-category of small $\infty$-categories and the `huge' $\infty$-category of large $\infty$-categories.

Suppose $K$ is a simplicial set and $\category{C}$ is an $\infty$-category. By $\Fun(K, \category{C})$, we mean the $\infty$-category of maps $K \to \category{C}$. By $\Map(K, \category{C})$, we mean the $\infty$-groupoid of such maps; that is,
\begin{equation*}
  \Map(K, \category{C}) = \Fun(K, \category{C})^{\simeq},
\end{equation*}
where $(-)^{\simeq}\colon \SSet \to \Kan$ denotes the \emph{core} functor, i.e.\ the functor associating to a simplicial set $K$ the largest Kan complex contained in it.


\subsection{The marked-scaled model structure}
\label{ssc:marked-scaled_model_structure}

We will need two different models for $(\infty,2)$-categories: Lurie's theory of scaled simplicial sets, as laid out in \cite{lurie2009infinity}; and Abell\'an--Stern's theory of marked-scaled simplicial sets, as explained in \cite{garcia2cartesianfibrationsii}. We will assume a knowledge of scaled simplicial sets. We give a basic outline of the portions of the theory of marked-scaled simplicial sets which we will need.

A marked-scaled simplicial set is a triple $(X, E_{X}, T_{X})$, where $E_{X} \subseteq X_{1}$ is a collection of edges of $X$ containing all degenerate edges, and $T_{X} \subseteq X_{2}$ is a collection of triangles of $X$ containing all degenerate triangles. We will use the following notation.
\begin{itemize}
  \item We will denote the category of marked-scaled simplicial sets by $\SSetms$.

  \item To save on notation, we will sometimes denote the marked-scaled simplicial set $(X, E_{X}, T_{X})$ by $X^{E_{X}}_{T_{X}}$, particularly in the case that $E_{X}$ or $T_{X}$ are $\sharp$ or $\flat$, the maximum (resp. minimum) markings and scalings. For example, the bimarked simplicial set $X^{\sharp}_{\flat}$ has all 1-simplices marked and only degenerate 2-simplices scaled.

  \item Let $(\Delta^{n}, E, T)$ be a marked-scaled $n$-simplex. For any simplicial subset $S \subseteq \Delta^{n}$, we will denote by $(S, E, T)$ the simplicial subset $S$ together with the inherited marking and scaling.
\end{itemize}

There is a set of marked-scaled anodyne morphisms, which have the left lifting property with respect to marked-scaled fibrations. We will not need to use the full power of the marked-scaled anodyne morphisms, so we content ourselves with an incomplete description.

\begin{definition}
  \label{def:ms-anodyne_morphisms}
  The set of ms-anodyne morphisms is a saturated set of morphisms between marked-scaled simplicial sets containing the following classes of morphisms:
  \begin{enumerate}[label=(A\arabic*)]
    \item\label{item:innerms} Inner horn inclusions
      \begin{equation*}
        (\Lambda^{n}_{i}, \flat, \{\Delta^{\{i-1,i,i+1\}}\}) \to (\Delta^{n}, \flat, \{\Delta^{\{i-1,i,i+1\}}\}),
      \end{equation*}
      for $n \geq 2$ and $0 < i < n$.

    \item\label{item:outerms} Outer horn inclusions
      \begin{equation*}
        (\Lambda^{n}_{n}, \{\Delta^{\{n-1,n\}}\}, \{\Delta^{\{0, n-1, n\}}\}),
      \end{equation*}
      for $n \geq 1$.
  \end{enumerate}
\end{definition}

\begin{example}
  \label{prop:sharp_marked_right_anodyne}
  The marked-scaled anodyne morphisms encapsulate both left- and marked-anodyne morphisms.
  \begin{itemize}
    \item For any right anodyne morphism $A \hookrightarrow B$, the morphism $A^{\sharp}_{\sharp} \hookrightarrow B^{\sharp}_{\sharp}$ is marked-scaled anodyne.

    \item For any marked anodyne morphism $(A, \mathcal{E}) \to (B, \mathcal{F})$, the morphism $A^{\mathcal{E}}_{\sharp} \to B^{\mathcal{F}}_{\sharp}$ is marked-scaled anodyne.
  \end{itemize}
\end{example}

\begin{theorem}
  There is a model structure on the category $\SSetms$, whose trivial cofibrations are contain the set of marked-scaled anodyne maps, and whose fibrant objects are $\infty$-bicategories with the equivalences marked and thin simplices scaled.
\end{theorem}

\begin{theorem}
  \label{thm:quillen_equiv_ms_and_scaled}
  There is a Quillen equivalence
  \begin{equation*}
    (-)_{\flat} : \SSetsc \longleftrightarrow \SSetms : G,
  \end{equation*}
  where $(-)^{\flat}$ endows any scaled simplicial set with the flat marking, and $G$ forgets the marking.
\end{theorem}

\subsection{Selected results from Monoidal Pull-Push I}
\label{ssc:selected_results_from_mppi}

We will need several of the results of the first part of this paper, Monoidal Pull-Push I. Both of these give sufficient conditions on a functor $p\colon \category{C} \to \category{D}$ so that the induced functor $\Span(\category{C}) \to \Span(\category{D})$ is a cocartesian fibration. Here, the subcategories $\category{C}\downdag$ and $\category{C}\updag$ pick out distinguished classes of morphisms to which the legs of the spans of $\Span(\category{C})$ are allowed to belong, and similarly for $\category{D}\downdag$ and $\category{D}\updag$.

\begin{theorem}
  \label{thm:old_barwick}
  Let $p\colon \triple{C} \to \triple{D}$ be a functor between adequate triples such that $p\colon \category{C} \to \category{D}$ is an inner fibration which satisfies the following conditions.
  \begin{enumerate}
    \item Each morphism $g \in \category{D}\downdag$ admits a lift to a morphism in $\category{C}\downdag$ (given a lift of the source) which is both $p$-cocartesian and $p\downdag$-cocartesian.

    \item Consider a commutative square
      \begin{equation*}
        \sigma = \quad
        \begin{tikzcd}
          y'
          \arrow[r, rightarrowtail, "f'"]
          \arrow[d, two heads, swap, "g'"]
          & x'
          \arrow[d, "g"]
          \\
          y
          \arrow[r, rightarrowtail, "f"]
          & x
        \end{tikzcd}
      \end{equation*}
      in $\category{C}$ where $g'$ belongs to $\category{C}\updag$, and $f$ and $f'$ belong to $\category{C}\downdag$. Suppose that $f$ is $p$-cocartesian. Then $f'$ is $p'$-cocartesian if and only if $\sigma$ is an ambigressive pullback square (and in particular $g \in \category{C}\updag$).
  \end{enumerate}

  Then spans of the form
  \begin{equation*}
    \begin{tikzcd}
      & z
      \arrow[dl, two heads, swap, "g"]
      \arrow[dr, rightarrowtail, "f"]
      \\
      x
      && y
    \end{tikzcd}
  \end{equation*}
  are cocartesian, where $g$ is $p\updag$-cartesian and $f$ is $p$-cocartesian.
\end{theorem}

\begin{theorem}
  \label{thm:new_barwick}
  Let $p\colon \triple{C} \to \triple{D}$ be a functor between adequate triples such that $p\colon \category{C} \to \category{D}$ is an inner fibration which satisfies the following conditions.
  \begin{enumerate}
    \item The subcategory $\category{C}\updag \subseteq \category{C}$ consists of all $p$-cartesian morphisms in $\category{C}$; that is, an $n$-simplex in $\category{C}$ belongs to $\category{C}\updag$ if and only if each $1$-simplex it contains is $p$-cartesian.

    \item The map $p\updag\colon \category{C}\updag \to \category{D}\updag$ is a cartesian fibration.

    \item Consider a square
      \begin{equation*}
          \sigma = \quad
          \begin{tikzcd}
            y'
            \arrow[r, "f'"]
            \arrow[d, two heads, swap, "g'"]
            & x'
            \arrow[d, two heads, "g"]
            \\
            y
            \arrow[r, rightarrowtail, "f"]
            & x
          \end{tikzcd}
      \end{equation*}
      in $\category{C}$ where $g$ and $g'$ belong to $\category{C}\updag$, and $f$ belongs to $\category{C}\downdag$. Further suppose that $f$ is $p$-cocartesian. Then $f'$ belongs to $\category{C}\downdag$, and is both $p$-cocartesian and $p\downdag$-cocartesian.
  \end{enumerate}
  Then spans of the form
  \begin{equation*}
    \begin{tikzcd}
      & z
      \arrow[dl, two heads, swap, "g"]
      \arrow[dr, rightarrowtail, "f"]
      \\
      x
      && y
    \end{tikzcd}
  \end{equation*}
  are cocartesian, where $g$ is $p\updag$-cartesian and $f$ is $p$-cocartesian.
\end{theorem}

\subsection{Acknowledgements}
\label{ssc:acknowledgements}

We would like to thank his advisor, Tobias Dyckerhoff, for his patience and guidance. We would also like to thank Fernando Abell{\'a}n Garc{\'i}a for many helpful conversations about the results contained in this paper, especially those pertaining to the twisted arrow category.

\end{document}
